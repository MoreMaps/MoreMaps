<div class="dialog-container">
    <div class="dialog-header">
        <div class="header-content">
            <div class="icon-wrapper">
                <mat-icon class="header-icon">directions_car</mat-icon>
            </div>

            <div class="header-text">
                @if (!isEditing()) {
                    <h2 class="dialog-title">
                        {{ displayData.item.alias || displayData.item.marca + ' ' + displayData.item.modelo }}
                    </h2>
                    <p class="dialog-subtitle">{{ displayData.item.matricula }}</p>
                    <p class="dialog-coords">
                        {{ displayData.item.marca }} {{ displayData.item.modelo }} {{ displayData.item.anyo }}
                    </p>
                } @else {
                    <h2 class="dialog-title">Editar veh√≠culo</h2>
                    <p class="dialog-subtitle">Modifica los detalles</p>
                }
            </div>
        </div>

        <button mat-icon-button (click)="close()" class="close-btn">
            <mat-icon>close</mat-icon>
        </button>
    </div>

    <div class="dialog-body">
        @if (!isEditing()) {
            <div class="actions-list">
                <button class="action-item" (click)="onNewRoute()">
                    <div class="icon-circle green">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="action-svg">
                            <path d="M5 12h14m-7-7l7 7-7 7"/>
                        </svg>
                    </div>
                    <span class="action-label green-text">NUEVA RUTA</span>
                </button>

                <button class="action-item" (click)="onEdit()">
                    <div class="icon-circle green">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="action-svg">
                            <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
                        </svg>
                    </div>
                    <span class="action-label green-text">EDITAR</span>
                </button>

                <button class="action-item" (click)="onDelete()">
                    <svg viewBox="0 0 24 24" fill="currentColor" class="action-svg trash-svg">
                        <path d="M19 6h-2c0-1.657-1.343-3-3-3h-4c-1.657 0-3 1.343-3 3H5c-1.103 0-2 .897-2 2v2h18V8c0-1.103-.897-2-2-2zM5 11v9a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-9H5zm4 3h1.5v3H9v-3zm4.5 0H15v3h-1.5v-3z"/>
                    </svg>
                    <span class="action-label orange-text">ELIMINAR</span>
                </button>
            </div>
        }

        @else {
            <app-edit-vehicle
                [vehicle]="displayData.item"
                [auth]="auth"
                (close)="onCancelEdit()"
                (update)="onUpdateSuccess($event)">
            </app-edit-vehicle>
        }
    </div>

    @if (isDeleting()) {
        <app-delete-confirmation-popup
            [matricula]="displayData.item.matricula"
            [alias]="displayData.item.alias || displayData.item.matricula"
            [auth]="auth"
            (close)="onCancelDelete()"
            (success)="onDeleteSuccess($event)">
        </app-delete-confirmation-popup>
    }
</div>
