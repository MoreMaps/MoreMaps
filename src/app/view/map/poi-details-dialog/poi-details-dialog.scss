// 1. EL COMPONENTE (:host)
:host {
    display: block;
    width: 100%;
    height: auto;
    box-sizing: border-box;
}

// 2. EL CONTENEDOR
.poi-card-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background-color: var(--color-white);
    border-radius: var(--radius-md);

    // Altura automática real.
    // Si el padre intenta restringirlo, esto empujará hacia afuera.
    height: auto;
    width: 100%;
    max-width: 100%;

    box-sizing: border-box;
    gap: 1rem;

    overflow: hidden;
    margin: 0 0 10px;
}

.poi-info {
    display: flex;
    min-width: 0;
    flex: 1;
    flex-direction: column;
    justify-content: center;
    overflow: visible; // No ocultar nada aquí

    .poi-title {
        margin: 0 0 0.25rem 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--color-black);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .poi-coords {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
        font-size: 0.75rem;
        color: var(--mat-sys-on-surface-variant);

        .coord-row {
            display: flex;
            gap: 0.5rem;
            align-items: center;

            .label { font-weight: 500; opacity: 0.7; }
            .value { font-family: monospace; }
        }
    }
}

.poi-actions {
    display: flex;
    gap: 0.75rem;
    align-items: center;
    flex-shrink: 0;

    .action-btn {
        border: none;
        outline: none;
        cursor: pointer;
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease-in-out;
        background-color: var(--color-lavender);

        mat-icon { font-size: 24px; width: 24px; height: 24px; }

        &:hover {
            filter: brightness(0.8);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        &:active { transform: scale(0.95); }

        &.save-btn {
            background-color: var(--color-mint-green-light);
            mat-icon { color: var(--color-teal-dark); }
        }
        &.close-btn {
            background-color: var(--color-orange);
            mat-icon { color: var(--color-black); opacity: 0.8; }
        }
        &.next-btn {
            background-color: var(--color-lavender);
        }
    }
}

// =========================================================
// MEDIA QUERIES
// =========================================================
@media (max-width: 900px) {
    .poi-card-container {
        flex-direction: column;
        align-items: center;
        text-align: center;

        // Padding superior e inferior generoso para evitar cortes
        padding: 1.5rem 1rem;

        // Forzar altura automática
        height: auto !important;
        min-height: auto !important;

        margin-bottom: 3em;
    }

    .poi-info {
        width: 100%;
        // flex: none es VITAL. Evita que el texto intente calcular su altura
        // basándose en el espacio disponible (que es erróneo)
        flex: none !important;
        margin-bottom: 1rem;

        .poi-title {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            white-space: normal;
            // Eliminar restricciones de texto en móvil
            overflow: visible;
            text-overflow: clip;
        }

        .poi-coords { align-items: center; }
    }

    .poi-actions {
        width: 100%;
        justify-content: center;
        padding-bottom: 0.25rem;

        .action-btn {
            width: 42px;
            height: 42px;
            mat-icon { font-size: 22px; width: 22px; height: 22px; }
        }
    }
}

@media (max-width: 900px) {
    .poi-card-container { padding: 1rem 0.5rem; }
    .poi-info {
        margin-bottom: 0.75rem;
        .poi-title { font-size: 1rem; }
        .poi-coords { font-size: 0.75rem; }
    }
    .poi-actions .action-btn { width: 38px; height: 38px; }
}

// =========================================================
// TEMA OSCURO
// =========================================================
:host-context(.dark-theme) {
    .poi-card-container { background-color: var(--color-purple-dark); }
    .poi-info {
        .poi-title { color: var(--color-white); }
        .poi-coords { color: var(--color-lavender); }
    }
    .poi-actions .action-btn {
        filter: brightness(0.9);
        &:hover { filter: brightness(1.1); }
        &.save-btn { background-color: var(--color-mint-green); filter: brightness(1); }
        &.close-btn { filter: brightness(1); }
    }
}

// =========================================================
// LA SOLUCIÓN AL "CORTE" (THE NUCLEAR FIX)
// =========================================================
// Esto fuerza al contenedor de Material Dialog a adaptarse
// al contenido que hemos definido arriba, ignorando sus propios cálculos.
::ng-deep {
    // Apunta al contenedor específico si está dentro de un dialog
    .mat-mdc-dialog-container,
    .mat-mdc-dialog-surface {
        height: auto !important; // Permitir crecer
        max-height: none !important; // Quitar límites artificiales (salvo el de pantalla)
        overflow: visible !important; // DEJAR DE CORTAR
        display: block !important; // Evitar flexbox centers extraños en el padre
    }

    // Si estás usando <mat-dialog-content> dentro del HTML
    .mat-mdc-dialog-content {
        max-height: none !important;
        overflow: visible !important;
        padding: 0 !important; // Dejar que nuestro padding controle el espacio
    }

}
